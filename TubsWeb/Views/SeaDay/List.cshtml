@model IEnumerable<Spc.Ofp.Tubs.DAL.Entities.SeaDay>

@* For now, create this in the View. *@
@{
    IEnumerable<Tuple<string, string>> crumbs = new List<Tuple<string, string>>()
    {
        Tuple.Create(Url.Action("Index", "Trip"), "Trips"),
        Tuple.Create(Url.Action("Details", "Trip", new { tripId = ViewBag.TripId }), ViewBag.TripNumber as string),
        Tuple.Create("#", "Sea Days")
    };
}

@{ Html.RenderPartial("_BreadCrumbs", crumbs); }

@* TODO Add vertical lines to header *@
<table class="table table-bordered table-condensed table-striped">
    <thead>
        <tr>
            <th>&nbsp;</th>
            <th>&nbsp;</th>
            <th>&nbsp;</th>
            <th colspan="2">Free floating objects</th>
            <th colspan="2">Anchored floating objects</th>
            <th>&nbsp;</th>
            <th>&nbsp;</th>
        </tr>
        <tr>
            <th>&nbsp;</th>
            <th>Start of Day</th>
            <th>Start of Day (UTC)</th>
            <th>No school</th>
            <th>With school</th>
            <th>No school</th>
            <th>With school</th>
            <th>Free schools</th>
            <th>GEN-3 Event?</th>
        </tr>
    </thead>
<tbody>

@foreach (var item in Model.Select((x, i) => new { Data = x, Index = i})) {
    @Html.DisplayFor(m => item.Data, new { counter = item.Index + 1 })
}
</tbody>
</table>

@if (0 == Model.Count())
{
    var options = new AjaxOptions { HttpMethod = "Post", UpdateTargetId = "autoFillResults", OnFailure = "onAutoFail", OnSuccess = "onAutoSuccess" };
    <div id="noDaysDiv">
        <p>
            No days recorded. @Html.ActionLink("Auto fill days?", "AutoFill", new { tripId = ViewBag.TripId }, new { id = "autoFill" })
        </p>
    </div>
    <div id="autoFillResults"></div>
    
}

@section AdditionalScripts {   
    <script type="text/javascript">
        function onAutoFail(xhr, status, error) {
            alert("Epic fail");
        }

        function onAutoSuccess(data, status, xhr) {
            alert("It worked?");
        }
    </script>

    <script type="text/javascript">
        $(function () {
            $('#autoFill').click(function () {
                $.ajax({
                    url: this.href,
                    type: 'POST',
                    success: onAutoSuccess
                });
                return false;
            });
        });
    </script>
}
