@model Spc.Ofp.Tubs.DAL.Entities.Trip
@using Spc.Ofp.Tubs.DAL.Entities
@using Spc.Ofp.Tubs.DAL.Common

@* For now, create this in the View. *@
@{
    IEnumerable<Tuple<string, string>> crumbs = new List<Tuple<string, string>>()
    {
        Tuple.Create(Url.Action("Index", "Trip"), "Trips"),
        Tuple.Create(Url.Action("Details", "Trip", new { tripId = ViewBag.TripId }), Model.SpcTripNumber ?? "This Trip"),
        Tuple.Create("#", "GEN-2 Events")
    };
}

@{ Html.RenderPartial("_BreadCrumbs", crumbs); }

<fieldset>
    <legend>Interactions with Species of Special Interest</legend>
    @{ Html.RenderPartial("_Interactions", Model.Interactions); }
</fieldset>

@if (!Model.IsReadOnly)
{
    @* Passing the argument to 'done' requires the String.Format call *@
    @* http://stackoverflow.com/questions/6550290/ajaxoptions-onsuccess-callback-with-parameter-not-working *@
    var options = new AjaxOptions { HttpMethod = "Post", UpdateTargetId = "gen2Interactions", OnSuccess = String.Format("clearForm('#{0}')", "addInteractionForm") };
    using (Ajax.BeginForm("AddInteraction", null, options, new { id = "addInteractionForm" }))
    {
        @Html.ValidationSummary(false)
        <fieldset>
            <legend>Add Interaction</legend>
            @{ var interaction = new SpecialSpeciesInteraction(); }
            @Html.EditorFor(i => interaction)
            <p>
                <input type="Submit" value="Add" style="font-size: 1.0em;"/>
                <input type="Reset" value="Cancel" style="font-size: 1.0em;"/>
            </p>
        </fieldset>
    }
}

<p>
<a href='@Url.RouteUrl("TripDetails", new { tripId = ViewBag.TripId })'>Back to Trip</a>
</p>


@section AdditionalScripts {
    @{ Html.RenderPartial("_DateTimePickerInit"); }
}
