<!DOCTYPE html>
<html>
<head>
    <title>Map debug page</title>
    <link rel="stylesheet" href="/Content/leaflet.css" />
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="/Content/leaflet.ie.css" />
    <![endif]-->
</head>
<body>
    <h1>Map</h1>
    <div id="mapX" style="width: 700px; height: 500px;"></div>

    <script src="/bundles/jquery?v=UPMm7AQqEQKrhcvioar2IKFlUpE0qtEzsx8Xq9CvVhI1"></script>
    <script src="/bundles/jsextlibs?v=scYy1uxyxlj5qPLz6PgAtZjmCwGNTRF5x5spuCqcTbM1"></script>    <script src="/Scripts/App/datacontext.js"></script>    <script src="/Scripts/leaflet.js"></script>    <script src="/Scripts/tubs-leaflet.js"></script>    <script>
        $(function () {
            var tripMap = tubs.TripMap('mapX');
            tubs.getTripTrack(
                70,
                function (data) {
                    tripMap.track.addData(data);
                },
                function () {
                    toastr.error('Something went wrong loading track data');
                }
            );
        });
    </script>    <!--    <script>
        $(function () {
            // One layer per GeoJSON object
            var trackLayer = L.geoJson();
            var positionsLayer = L.geoJson();
            
            // An additional layer for our local tile server
            var tileLayer = L.tileLayer('http://nouofputil01/mbtiles/test/{z}/{x}/{y}.png', {
                maxZoom: 9,
                attribution: 'Map data &copy; CROP'
            });

            // Create the map with all available layers.
            // If the layer will be optional, we can leave it out of here
            // but put it into the overlayMaps object below and it will be available
            // but off by default
            var map = L.map('mapX', {
                layers: [tileLayer, trackLayer, positionsLayer]
            }).setView([-9.0, 150.0], 4);

            // This object allows us to name the base layer
            var baseMaps = {
                "CROP": tileLayer
            };

            // These are layers that can be enabled/disabled via the layer control
            var overlayMaps = {
                "Track": trackLayer,
                "Positions": positionsLayer
            };

            L.control.layers(baseMaps, overlayMaps).addTo(map);

            // The scale control included with Leaflet only does km and miles
            // There's a third party control (leaflet.customscale) that can handle
            // custom units including nautical miles
            L.control.scale().addTo(map);

            // Remotely load track
            $.get('/Trip/70/track.geojson').done(function (data) {
                trackLayer.addData(data);
            });

            // Remotely load positions
            $.get('/Trip/70/positions.geojson').done(function (data) {
                positionsLayer.addData(data);
            });
        });


    </script>    -->    <!--    <script src="/Scripts/OpenLayers.js"></script>
    <script>
        $(function () {
            var map,
                layer,
                epsg4326,
                options;

            options = {
                theme: null
            };

            var geojson_format = new OpenLayers.Format.GeoJSON();
            var trackLayer = new OpenLayers.Layer.Vector();
            var positionsLayer = new OpenLayers.Layer.Vector();

            epsg4326 = new OpenLayers.Projection("EPSG:4326");
            epsg3857 = new OpenLayers.Projection("EPSG:3857");
            OpenLayers.IMAGE_RELOAD_ATTEMPTS = 3;

            OpenLayers.ImgPath = '/Content/OpenLayers/img/';
            map = new OpenLayers.Map('mapX', options);
            layer = new OpenLayers.Layer.XYZ(
              "Layer",
              ["http://nouofputil01/mbtiles/test/${z}/${x}/${y}.png"],
              {
                  sphericalMercator: true,
                  attribution: "CROP &copy; ",
                  wrapDateLine: true,
                  numZoomLevels: 9
              }
            );
            map.addLayers([layer, trackLayer, positionsLayer]);
            map.addControl(new OpenLayers.Control.ScaleLine({
                topOutUnits: 'nmi',
                topInUnits: 'm'
            }));
            map.addControl(new OpenLayers.Control.MousePosition());
            var center = new OpenLayers.LonLat(150, -9.0).transform(epsg4326, map.getProjectionObject());
            map.setCenter(center, 5);

            $.get('/Trip/70/track.geojson').done(function (data) {
                console.log("track");
                //trackLayer.addFeatures(geojson_format.read(data));
            });

            $.get('/Trip/70/positions.geojson').done(function (data) {
                console.log("positions");
                console.log(data);
                positionsLayer.addFeatures(geojson_format.read(data));
            });

            // http://localhost:1898/Trip/70/track.geojson
        });
    </script>
    -->
</body>
</html>
